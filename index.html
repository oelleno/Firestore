<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Storage Upload</title>
</head>
<body>
    <h2>Firebase Storage Image Upload & Download</h2>
    
    <input type="file" id="fileInput">
    <button onclick="uploadImage()">Upload</button>

    <h3>Uploaded Image:</h3>
    <img id="uploadedImage" src="" width="300" style="display:none;">

    <script type="module">
        // Firebase SDK 불러오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.0/firebase-app.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.3.0/firebase-storage.js";

        // Firebase 설정
        const firebaseConfig = {
            apiKey: "AIzaSyAxlXZTfOgO4ZrIfXp4t6sAjArTmMQrwuQ",
            authDomain: "fitgirlviki.firebaseapp.com",
            projectId: "fitgirlviki",
            storageBucket: "fitgirlviki.firebasestorage.app", // ✅ 최종 확정 도메인
            messagingSenderId: "207468197936",
            appId: "1:207468197936:web:70ea3baa845e40372255f5"
        };

        // Firebase 초기화
        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);

        // 파일 업로드 함수
        window.uploadImage = async function () {
            const fileInput = document.getElementById("fileInput");
            if (!fileInput.files.length) {
                alert("파일을 선택하세요!");
                return;
            }

            const file = fileInput.files[0];
            const storageRef = ref(storage, `images/${file.name}`);

            try {
                // Firebase Storage에 파일 업로드
                await uploadBytes(storageRef, file);
                console.log("파일 업로드 완료!");

                // 업로드한 파일의 URL 가져오기
                const downloadURL = await getDownloadURL(storageRef);
                console.log("파일 다운로드 URL:", downloadURL);

                // 이미지 태그에 다운로드된 이미지 표시
                const uploadedImage = document.getElementById("uploadedImage");
                uploadedImage.src = downloadURL;
                uploadedImage.style.display = "block";

            } catch (error) {
                console.error("업로드 오류:", error);
            }
        };
    </script>
</body>
</html>
